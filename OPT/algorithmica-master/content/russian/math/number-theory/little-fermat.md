---
title: Малая теорема Ферма
---

**Теорема.** $a^p \equiv a \pmod p$ для всех $a$, не делящихся на $p$.

**Доказательство**. (для понимания несущественно, можно пропустить)

$$
\begin{aligned}
a^p &= (\underbrace{1+1+\ldots+1+1}_\text{$a$ раз})^p
\\  &= \sum_{x_1+x_2+\ldots+x_a = p} P(x_1, x_2, \ldots, x_a) & \text{(раскладываем по определению)}
\\  &= \sum_{x_1+x_2+\ldots+x_a = p} \frac{p!}{x_1! x_2! \ldots x_a!} & \text{(какие слагаемые не делятся на $p$?)}
\\  &\equiv P(p, 0, \ldots, 0) + \ldots + P(0, 0, \ldots, p) & \text{(все остальные не убьют $p$ в знаменателе)}
\\  &= a
\end{aligned}
$$

Здесь $P(x_1, x_2, \ldots, x_n) = \frac{k}{\prod (x_i!)}$ это мультиномиальный коеффициент — количество раз, которое элемент $a_1^{x_1} a_2^{x_2} \ldots a_n^{x_n}$ появится при раскрытии скобки $(a_1 + a_2 + \ldots + a_n)^k$.

Теперь два раза «поделим» наш результат на $a$.

$$ a^p \equiv a \implies a^{p-1} \equiv 1 \implies a^{p-2} \equiv a^{-1} $$

Получается, что $a^{p-2}$ ведет себя как $a^{-1}$, что нам по сути и нужно.
Посчитать $a^{p-2}$ можно за $O(\log p)$ бинарным возведением в степень.

---

{{ Утверждение |Название=Малая теорема Ферма |Показать название=1
|Утверждение=Пусть $p$ - простое число, $a$ - целое число, которое
не делится на $p$. Тогда $a^{p - 1} \\equiv 1 \\mod p$. |Доказательство=
Рассмотрим числа $a, 2a, 3a, ... ,(p - 1)a$. Заметим, что в данном
наборе присутствуют все остатки от $1$ до $p - 1$ (доказательство
остается читателю в качестве упражнения).

Перемножим эти числа: слева остались числа в исходном виде, а справа мы
пользуемся тем, что данный набор содержит все остатки от $1$ до $p -
1$.

$a \\cdot 2a \\cdot 3a \\dots \\cdot (p-1)a \\equiv 1 \\cdot 2 \\cdot 3
\\dots \\ \\cdot (p - 1) \\mod p$

$(p-1)\!a^{p-1} \\equiv (p-1)\! \\mod p$

Так как $p$ - простое число, то оно взаимно просто с любым числом от $1$
до $p - 1$, то есть и с $(p - 1)\!$. Поэтому мы можем сократить
факториал в двух частях равенства. Получим:

$a^{p-1} \\equiv 1 \\mod p$. }}

[Категория:Конспект](Категория:Конспект "wikilink") [Категория:Теория
чисел](Категория:Теория_чисел "wikilink")