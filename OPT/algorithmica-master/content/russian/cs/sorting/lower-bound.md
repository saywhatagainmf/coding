---
title: Необходимое число сравнений для сортировки
weight: 7
authors:
- Сергей Слотин
draft: true
---

Мы рассмотрели несколько различных сортировок со средним временем работы $O(n \log n)$. Закономерный вопрос — а можно ли быстрее?

Выясняется, что если всё， что мы можем делать — это сравнения двух элементов, то $O(n \log n)$ это не только верхняя оценка оптимального алгоритма, но и нижняя.

Пусть мы хотим отсортировать массив размера $n$. Для простоты предположим, что все элементы различные — очевидно, для нас это худший случай. Существует ровно $n!$ различных перестановок этого массива, среди которых мы хотим сравнениями найти ту единственную, которая соответствует отсортированному массиву.

Когда мы узнаем результат сравнения двух элементов, мы можем отбросить какие-то из перестановок как невалидные (противоречащие нашим наблюдениям), и тогда область поиска (множество валидных перестановок) сузится. Дальше мы можем провести другие сравнения, результаты которых дадут нам больше информации, которая позволит нам работать с прогрессивно меньшими областями поиска.

Пусть мы сделали $k$ сравнений, которые сузили область поиска до одной перестановки — иными словами, по результатам этих сравнений мы можем восстановить перестановку идеально и отсортировать массив. Так как каждое сравнение вернуло либо «да», либо «нет», существует $2^k$ различных комбинаций результатов сравнений. Чтобы существовала такая последовательность сравнений (где следующее сравнение может быть зависимым от предыдущих),

$$
n! < 2^k
$$

что в свою очередь означает, что

$$
\log_2 (n!) = \sum_{k=1}^n \log_2 k < \log_2 (2^k) = k
$$

Так как, $\sum \log k = \Omega(n \log n)$, минимальное число сравнений $k$ тоже $\Omega(n \log n)$.

Для $n$ от $1$ до $15$ нижние границы такие:

$$
0, 1, 3, 5, 7, 10, 13, 16, 19, 22, 26, 30, 34, 38, 42
$$

[Sorting numbers](https://oeis.org/A036604)
